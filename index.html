<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rey Studio | Photo Strip Creator</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link href="https://fonts.cdnfonts.com/css/halimun" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>

<body>
    <!-- Screen 1: Welcome -->
    <div class="screen active" id="screen1">
        <div class="welcome-container">
            <div class="logo-animation">
                <div class="logo-circle"></div>
                <div class="logo-circle"></div>
                <div class="logo-circle"></div>
            </div>
            <h1 class="main-title">Rey Studio</h1>
            <p class="welcome-subtitle">Create beautiful photo strips with your favorite moments</p>
            <button class="cta-button" onclick="showScreen('screen2')">
                <span class="button-text">Get Started</span>
                <span class="button-icon">‚Üí</span>
            </button>
        </div>
    </div>

    <!-- Screen 2: Instructions -->
    <div class="screen" id="screen2">
        <div class="screen-header">
            <h1 class="screen-title">How It Works</h1>
            <p class="screen-description">We'll guide you through creating a personalized photo strip. Choose a template, take photos, and customize your creation.</p>
        </div>
        
        <div class="steps-container">
            <div class="step-card">
                <div class="step-number">01</div>
                <div class="step-content">
                    <h3 class="step-title">Choose Template</h3>
                    <p class="step-description">Select from beautiful layouts</p>
                </div>
            </div>
            <div class="step-card">
                <div class="step-number">02</div>
                <div class="step-content">
                    <h3 class="step-title">Take Photos</h3>
                    <p class="step-description">Capture perfect moments</p>
                </div>
            </div>
            <div class="step-card">
                <div class="step-number">03</div>
                <div class="step-content">
                    <h3 class="step-title">Customize</h3>
                    <p class="step-description">Add your personal touch</p>
                </div>
            </div>
            <div class="step-card">
                <div class="step-number">04</div>
                <div class="step-content">
                    <h3 class="step-title">Download</h3>
                    <p class="step-description">Save & share memories</p>
                </div>
            </div>
        </div>
        
        <div class="action-buttons">
            <button class="secondary-button" onclick="showScreen('screen1')">
                <span class="button-text">Back</span>
            </button>
            <button class="cta-button" onclick="showScreen('screen3-template')">
                <span class="button-text">Continue</span>
                <span class="button-icon">‚Üí</span>
            </button>
        </div>
    </div>

    <!-- Screen 3: Template Selection with Overlay -->
    <div class="screen" id="screen3-template">
        <div class="screen-header">
            <h1 class="screen-title">Choose Your Style</h1>
            <p class="screen-description">Select a layout and overlay style for your photo strip</p>
        </div>

        <div class="tab-nav">
            <button class="tab-btn active" onclick="openTemplateTab('templates-tab')">
                <span class="tab-icon">üìê</span>
                <span>Templates</span>
            </button>
            <button class="tab-btn" onclick="openTemplateTab('overlays-tab')">
                <span class="tab-icon">üé®</span>
                <span>Overlays</span>
            </button>
        </div>

        <div id="templates-tab" class="tab-content active">
            <div class="template-category">
                <h3 class="category-title">Vertical Layouts</h3>
                <div class="template-options">
                    <div class="template-option vertical-2 selected" onclick="selectTemplate(this, 'vertical-2')">
                        <div class="template-badge">Popular</div>
                        <h3 class="template-title">Vertical 2</h3>
                        <div class="template-preview">
                            <div class="template-preview-cell cell-1"></div>
                            <div class="template-preview-cell cell-2"></div>
                        </div>
                    </div>
                    <div class="template-option vertical-3" onclick="selectTemplate(this, 'vertical-3')">
                        <h3 class="template-title">Vertical 3</h3>
                        <div class="template-preview">
                            <div class="template-preview-cell cell-1"></div>
                            <div class="template-preview-cell cell-2"></div>
                            <div class="template-preview-cell cell-3"></div>
                        </div>
                    </div>
                    <div class="template-option vertical-4" onclick="selectTemplate(this, 'vertical-4')">
                        <h3 class="template-title">Vertical 4</h3>
                        <div class="template-preview">
                            <div class="template-preview-cell cell-1"></div>
                            <div class="template-preview-cell cell-2"></div>
                            <div class="template-preview-cell cell-3"></div>
                            <div class="template-preview-cell cell-4"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="template-category">
                <h3 class="category-title">Horizontal Layouts</h3>
                <div class="template-options">
                    <div class="template-option horizontal-2" onclick="selectTemplate(this, 'horizontal-2')">
                        <h3 class="template-title">Horizontal 2</h3>
                        <div class="template-preview horizontal-preview">
                            <div class="template-preview-cell horizontal-cell cell-1"></div>
                            <div class="template-preview-cell horizontal-cell cell-2"></div>
                        </div>
                    </div>
                    <div class="template-option horizontal-3" onclick="selectTemplate(this, 'horizontal-3')">
                        <h3 class="template-title">Horizontal 3</h3>
                        <div class="template-preview horizontal-preview">
                            <div class="template-preview-cell horizontal-cell cell-1"></div>
                            <div class="template-preview-cell horizontal-cell cell-2"></div>
                            <div class="template-preview-cell horizontal-cell cell-3"></div>
                        </div>
                    </div>
                    <div class="template-option horizontal-4" onclick="selectTemplate(this, 'horizontal-4')">
                        <h3 class="template-title">Horizontal 4</h3>
                        <div class="template-preview horizontal-preview">
                            <div class="template-preview-cell horizontal-cell cell-1"></div>
                            <div class="template-preview-cell horizontal-cell cell-2"></div>
                            <div class="template-preview-cell horizontal-cell cell-3"></div>
                            <div class="template-preview-cell horizontal-cell cell-4"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="overlays-tab" class="tab-content">
            <div class="overlay-options">
                <div class="overlay-option selected" onclick="selectOverlay('none')">
                    <div class="overlay-preview clean-preview">
                        <div class="preview-content">
                            <span class="preview-icon">‚úï</span>
                            <span class="preview-label">No Overlay</span>
                        </div>
                    </div>
                    <div class="overlay-name">Clean</div>
                </div>
                <div class="overlay-option" onclick="selectOverlay('overlay/overlay1.png')">
                    <div class="overlay-preview floral-preview">
                        <div class="preview-content">
                            <span class="preview-icon">üå∏</span>
                        </div>
                    </div>
                    <div class="overlay-name">Floral Frame</div>
                </div>
                <div class="overlay-option" onclick="selectOverlay('overlay/overlay2.png')">
                    <div class="overlay-preview polaroid-preview">
                        <div class="preview-content">
                            <span class="preview-icon">üì∏</span>
                        </div>
                    </div>
                    <div class="overlay-name">Polaroid</div>
                </div>
                <div class="overlay-option" onclick="selectOverlay('overlay/overlay3.png')">
                    <div class="overlay-preview vintage-preview">
                        <div class="preview-content">
                            <span class="preview-icon">üï∞Ô∏è</span>
                        </div>
                    </div>
                    <div class="overlay-name">Vintage</div>
                </div>
                <div class="overlay-option upload-option" onclick="document.getElementById('overlayUpload').click()">
                    <div class="overlay-preview custom-preview">
                        <div class="preview-content">
                            <span class="preview-icon">üìÅ</span>
                            <span class="preview-label">Custom</span>
                        </div>
                    </div>
                    <div class="overlay-name">Upload</div>
                    <input type="file" id="overlayUpload" accept="image/*" style="display: none;" onchange="uploadOverlay(this)">
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="secondary-button" onclick="showScreen('screen2')">
                <span class="button-text">Back</span>
            </button>
            <button class="cta-button" onclick="initCamera()">
                <span class="button-text">Continue to Camera</span>
                <span class="button-icon">üì∑</span>
            </button>
        </div>
    </div>

    <!-- Screen 4: Camera View -->
    <div class="screen" id="screen4-camera">
        <div class="screen-header">
            <h1 class="screen-title">Capture Moments</h1>
            <p class="screen-description">Take photos for your beautiful photo strip</p>
        </div>
        
        <div class="error-message" id="cameraError"></div>
        
        <div class="camera-selection">
            <select id="cameraSelect" class="camera-select">
                <option value="">üìπ Select Camera</option>
            </select>
        </div>
        
        <div class="capture-preview-container">
            <div class="camera-wrapper">
                <div class="camera-container">
                    <video id="cameraView" autoplay playsinline class="camera-view no-mirror"></video>
                    <div class="flash" id="flash"></div>
                    <div class="camera-grid" id="cameraGrid"></div>
                    <div class="camera-frame"></div>
                </div>
                <div id="countdown"></div>
                <div class="capture-controls">
                    <button class="capture-button" onclick="capturePhoto()" id="captureBtn">
                        <div class="capture-circle">
                            <div class="capture-inner"></div>
                        </div>
                    </button>
                    <div class="photos-count">
                        <span class="photos-icon">üì∏</span>
                        <span id="photosCount">0</span>/<span id="maxPhotos">4</span>
                    </div>
                </div>
            </div>

            <div class="preview-sidebar">
                <div class="sidebar-header">
                    <h3 class="sidebar-title">Your Photos</h3>
                    <button class="clear-all-btn" onclick="retakeAllPhotos()">Clear All</button>
                </div>
                <div class="preview-thumbnails" id="previewSidebar">
                    <!-- Thumbnails will be added here -->
                </div>
            </div>
        </div>
        
        <div class="camera-controls">
            <button class="control-btn" onclick="switchCamera()">
                <span class="control-icon">üîÑ</span>
                <span>Switch Camera</span>
            </button>
            <button class="control-btn" onclick="toggleFlash()" id="flashBtn">
                <span class="control-icon">‚ö°</span>
                <span>Flash: Off</span>
            </button>
            <button class="control-btn" onclick="toggleGrid()" id="gridBtn">
                <span class="control-icon">‚èπÔ∏è</span>
                <span>Grid: Off</span>
            </button>
            <button class="control-btn" onclick="retakeLastPhoto()">
                <span class="control-icon">‚Ü©Ô∏è</span>
                <span>Retake Last</span>
            </button>
        </div>
        
        <div class="action-buttons">
            <button class="secondary-button" onclick="showScreen('screen3-template')">
                <span class="button-text">Back</span>
            </button>
            <button class="cta-button" onclick="goToCustomization()" id="customizeBtn" disabled>
                <span class="button-text">Customize</span>
                <span class="button-icon">üé®</span>
            </button>
        </div>
    </div>

    <!-- Screen 5: Customization -->
    <div class="screen" id="screen5-preview">
        <div class="screen-header">
            <h1 class="screen-title">Customize Your Strip</h1>
            <p class="screen-description">Add filters, backgrounds, and stickers to your photo strip</p>
        </div>

        <div class="preview-container">
            <div id="capture-container" class="strip-preview">
                <div class="strip-template" id="stripTemplate">
                    <!-- Photos will be inserted here -->
                </div>
                <div class="photo-footer">
                    <div class="footer-title">
                        <img id="footerLogo" src="logo/logo.png" alt="Rey Studio" class="footer-logo">
                    </div>
                    <div class="footer-subtitle">Created with Rey Studio</div>
                </div>
                
            </div>
        </div>

        <div class="customization-tabs">
            <div class="tab-nav">
                <button class="tab-btn active" onclick="openTab('background-tab')">
                    <span class="tab-icon">üé®</span>
                    <span>Background</span>
                </button>
                <button class="tab-btn" onclick="openTab('sticker-tab')">
                    <span class="tab-icon">‚ú®</span>
                    <span>Stickers</span>
                </button>
                <button class="tab-btn" onclick="openTab('frame-tab')">
                    <span class="tab-icon">üñºÔ∏è</span>
                    <span>Frames</span>
                </button>
                <button class="tab-btn" onclick="openTab('logo-tab')">
                    <span class="tab-icon">üè∑Ô∏è</span>
                    <span>Logo</span>
                </button>
            </div>

            <div id="background-tab" class="tab-content active">
                <div class="options-grid">
                    <!-- Solid Colors -->
                    <div class="background-option color-option" onclick="selectBackground(this, '#FF9AA2')">
                        <div class="background-preview color-1"></div>
                        <div class="option-name">Blush Pink</div>
                    </div>
                    <div class="background-option color-option" onclick="selectBackground(this, '#FFB7B2')">
                        <div class="background-preview color-2"></div>
                        <div class="option-name">Coral</div>
                    </div>
                    <div class="background-option color-option" onclick="selectBackground(this, '#FFDAC1')">
                        <div class="background-preview color-3"></div>
                        <div class="option-name">Peach</div>
                    </div>
                    <div class="background-option color-option" onclick="selectBackground(this, '#E2F0CB')">
                        <div class="background-preview color-4"></div>
                        <div class="option-name">Mint</div>
                    </div>
                    <div class="background-option color-option" onclick="selectBackground(this, '#B5EAD7')">
                        <div class="background-preview color-5"></div>
                        <div class="option-name">Aqua</div>
                    </div>

                    <!-- Gradients -->
                    <div class="background-option gradient-option" onclick="selectBackground(this, 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)')">
                        <div class="background-preview gradient-1"></div>
                        <div class="option-name">Purple Dream</div>
                    </div>
                    <div class="background-option gradient-option" onclick="selectBackground(this, 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)')">
                        <div class="background-preview gradient-2"></div>
                        <div class="option-name">Sunset</div>
                    </div>
                    <div class="background-option gradient-option" onclick="selectBackground(this, 'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)')">
                        <div class="background-preview gradient-3"></div>
                        <div class="option-name">Ocean</div>
                    </div>
                    <div class="background-option gradient-option" onclick="selectBackground(this, 'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)')">
                        <div class="background-preview gradient-4"></div>
                        <div class="option-name">Emerald</div>
                    </div>

                    <!-- Patterns -->
                    <div class="background-option pattern-option" onclick="selectBackground(this, 'url(\'background/background.png\')')">
                        <div class="background-preview pattern-1"></div>
                        <div class="option-name">Geometric</div>
                    </div>
                    <div class="background-option pattern-option" onclick="selectBackground(this, 'url(\'background/background1.png\')')">
                        <div class="background-preview pattern-2"></div>
                        <div class="option-name">Floral</div>
                    </div>

                    <!-- Upload -->
                    <div class="background-option upload-option" onclick="document.getElementById('bgUpload').click()">
                        <div class="background-preview upload-preview">
                            <div class="upload-content">
                                <span class="upload-icon">üìÅ</span>
                                <span class="upload-label">Custom</span>
                            </div>
                        </div>
                        <div class="option-name">Upload</div>
                        <input type="file" id="bgUpload" accept="image/*" style="display: none;" onchange="uploadBackground(this)">
                    </div>
                </div>
            </div>

            <div id="sticker-tab" class="tab-content">
                <div class="options-grid">
                    <div class="sticker-option" onclick="addSticker('sticker/Sticker.png')">
                        <div class="sticker-preview sticker-1">
                            <span class="sticker-emoji">üí´</span>
                        </div>
                        <div class="option-name">Sparkle</div>
                    </div>
                    <div class="sticker-option" onclick="addSticker('sticker/bear.png')">
                        <div class="sticker-preview sticker-2">
                            <span class="sticker-emoji">üß∏</span>
                        </div>
                        <div class="option-name">Bear</div>
                    </div>
                    <div class="sticker-option" onclick="addSticker('sticker/love.png')">
                        <div class="sticker-preview sticker-3">
                            <span class="sticker-emoji">üíñ</span>
                        </div>
                        <div class="option-name">Love</div>
                    </div>
                    <div class="sticker-option" onclick="addSticker('sticker/cat.png')">
                        <div class="sticker-preview sticker-4">
                            <span class="sticker-emoji">üê±</span>
                        </div>
                        <div class="option-name">Cat</div>
                    </div>
                </div>
            </div>

            <div id="frame-tab" class="tab-content">
                <div class="options-grid">
                    <div class="frame-option selected" onclick="applyFrame('none')">
                        <div class="frame-preview none-frame">
                            <div class="frame-label">No Frame</div>
                        </div>
                        <div class="option-name">Clean</div>
                    </div>
                    <div class="frame-option" onclick="applyFrame('polaroid')">
                        <div class="frame-preview polaroid-frame">
                            <div class="frame-inner"></div>
                        </div>
                        <div class="option-name">Polaroid</div>
                    </div>
                    <div class="frame-option" onclick="applyFrame('vintage')">
                        <div class="frame-preview vintage-frame">
                            <div class="frame-inner"></div>
                        </div>
                        <div class="option-name">Vintage</div>
                    </div>
                    <div class="frame-option" onclick="applyFrame('instax')">
                        <div class="frame-preview instax-frame">
                            <div class="frame-inner"></div>
                        </div>
                        <div class="option-name">Instax</div>
                    </div>
                    <div class="frame-option" onclick="applyFrame('wood')">
                        <div class="frame-preview wood-frame">
                            <div class="frame-inner"></div>
                        </div>
                        <div class="option-name">Wood</div>
                    </div>
                    <div class="frame-option" onclick="applyFrame('gold')">
                        <div class="frame-preview gold-frame">
                            <div class="frame-inner"></div>
                        </div>
                        <div class="option-name">Gold</div>
                    </div>
                </div>
            </div>

            <div id="logo-tab" class="tab-content">
                <div class="options-grid">
                    <div class="logo-option selected" onclick="changeLogo('logo/spring.png')">
                        <div class="logo-preview logo-1">
                            <span class="logo-emoji">üå∏</span>
                        </div>
                        <div class="option-name">Spring</div>
                    </div>
                    <div class="logo-option" onclick="changeLogo('logo/escape.png')">
                        <div class="logo-preview logo-2">
                            <span class="logo-emoji">üèÉ‚Äç‚ôÄÔ∏è</span>
                        </div>
                        <div class="option-name">Escape</div>
                    </div>
                    <div class="logo-option" onclick="changeLogo('logo/justdoit.png')">
                        <div class="logo-preview logo-3">
                            <span class="logo-emoji">üí™</span>
                        </div>
                        <div class="option-name">Just Do It</div>
                    </div>
                    <div class="logo-option upload-option" onclick="document.getElementById('logoUpload').click()">
                        <div class="logo-preview upload-logo">
                            <div class="upload-content">
                                <span class="upload-icon">üìÅ</span>
                                <span class="upload-label">Custom</span>
                            </div>
                        </div>
                        <div class="option-name">Upload</div>
                        <input type="file" id="logoUpload" accept="image/*" style="display: none;" onchange="uploadLogo(this)">
                    </div>
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="secondary-button" onclick="returnToCamera()">
                <span class="button-text">Retake Photos</span>
            </button>
            <button class="cta-button download-btn" onclick="downloadWithHtml2Canvas()" id="downloadBtn">
                <span class="button-text">Download Photo Strip</span>
                <span class="button-icon">‚¨áÔ∏è</span>
                <div class="spinner" id="downloadSpinner"></div>
            </button>
        </div>
        <div class="error-message" id="downloadError"></div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p class="loading-text">Creating your photo strip...</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>